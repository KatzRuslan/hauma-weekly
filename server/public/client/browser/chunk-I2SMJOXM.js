import{a as h,b as p}from"./chunk-SOWXVAUG.js";import{ba as y}from"./chunk-QKGFT424.js";import{e as m,f as c}from"./chunk-ZFMGZBFO.js";var f=m(h()),s=m(p());var w=(()=>{let i=class i{parseTileLink(r,o,a){let t={articleTypeId:"",sourceId:""},[e]=`${r}`.toLowerCase().replace("://","\u2207").split("/").map(l=>l.replace("\u2207","://")),n=a.find(({provide:l})=>l===e);t.sourceId=`${n?.id??""}`;let u=["youtube","instagram"].includes(n?.selector??"")?"video":"post";return t.articleTypeId=o.find(({selector:l})=>l===u)?.id??"",t}parseAuthorLink(r){let[o,a]=`${r}`.replace("https://","").replace("http://","").replace("www.","").replace("@","").replace("#","").split("/"),t=`${a??""}`.replace(/[A-Z]/g,e=>` ${e}`).replace(/\_/g," ").replace(/\./g," ").split(" ").filter(e=>!!e&&e.length).map(e=>e.length>3?`${e.charAt(0).toUpperCase()}${e.slice(1)}`.trim():e).join(" ").replace(/\s\s/g," ");return t.length||([t]=(o??"").replace("@","").split("."),t=`${t.charAt(0).toUpperCase()}${t.slice(1)}`),t}_createArticlesExcel(r){return c(this,null,function*(){let o=new f.Workbook,a=o.addWorksheet("Hauma Weekly Report");return a.columns=[{header:"Date",key:"date",width:16,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Type",key:"articleType",width:16,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Featured",key:"featured",width:16,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Category",key:"category",width:16,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Source",key:"source",width:16,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Author",key:"author",width:26,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Author Link",key:"authorLink",width:36,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Title",key:"title",width:40,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Post Link",key:"link",width:40,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Subject",key:"subject",width:16,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Issue Date",key:"edition",width:16,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}},{header:"Tags",key:"tags",width:40,style:{font:{name:"Roboto",family:4,size:11,bold:!0}}}],r.forEach(e=>{let n=a.addRow({date:(0,s.default)(e.date).format("DD MMM YYYY"),articleType:e.articleTypeName,featured:e.featured,category:e.categoryName,source:e.sourceName,author:e.authorName,authorLink:e.authorLink,title:e.title,link:e.link,subject:e.subject,edition:e.edition?(0,s.default)(e.edition).format("DD MMM YYYY"):"",tags:e.tags.join(", ")});n.font={name:"Roboto",family:4,size:11},n.commit()}),yield o.xlsx.writeBuffer()})}downloadArticles(r){return c(this,null,function*(){let o=yield this._createArticlesExcel(r),a=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=document.createElement("a"),e=window.URL.createObjectURL(a);t.href=window.URL.createObjectURL(a),t.download=`hauma-weekly.${(0,s.default)().format("DD-MMM-YYYY")}.xlsx`,t.click(),window.URL.revokeObjectURL(e)})}};i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=y({token:i,factory:i.\u0275fac,providedIn:"root"});let d=i;return d})();export{w as a};
