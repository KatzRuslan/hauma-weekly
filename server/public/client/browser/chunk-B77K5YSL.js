import{m as re,p as ae,q as pe}from"./chunk-3H4U2ACQ.js";import{A as z,Aa as E,Ba as k,Da as oe,Ea as le,Ia as se,Ja as B,S as Y,V,X as Z,ea as ee,ha as te,la as ie,pa as ne,ra as S,sa as M,w as X}from"./chunk-OLWWGVUT.js";import{Ab as j,Bb as f,Cb as R,Dc as w,Fb as q,I as F,Ia as P,Ib as T,Ja as L,Ma as U,Oa as N,Sa as O,Ua as _,Wb as K,Xb as G,Ya as Q,Za as $,Zb as J,cb as h,gb as v,ia as b,ib as x,jb as D,ka as y,l as H,nb as s,ob as p,pa as d,pb as I,qa as c,tb as C,vb as m,wb as u,zb as W}from"./chunk-QKGFT424.js";import{a as g,b as A}from"./chunk-ZFMGZBFO.js";function he(o,r){if(o&1){let i=C();s(0,"input",1),m("ngModelChange",function(e){d(i);let n=u();return c(n.inputValue=e)})("keyup.enter",function(){d(i);let e=u();return c(e.inputValue&&e.inputValue!=e.value?e.changeValue():void 0)}),p(),s(1,"div",2)(2,"p-button",3),m("onClick",function(){d(i);let e=u();return c(e.changeValue())}),p(),s(3,"p-button",4),m("onClick",function(){d(i);let e=u();return c(e.changeMode(!1))}),p()()}if(o&2){let i=u();v(i.inputStyleClass),h("ngModel",i.inputValue),_(2),h("styleClass",i.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)("disabled",!i.inputValue||i.inputValue==i.value),_(1),h("styleClass",i.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)}}function Ce(o,r){if(o&1&&(s(0,"a",9),f(1),p()),o&2){let i=u(2);h("href",i.link,U),_(1),R(i.value)}}function fe(o,r){if(o&1&&(s(0,"span",10),f(1),p()),o&2){let i=u(2);_(1),R(i.value)}}function xe(o,r){if(o&1){let i=C();s(0,"div",5),x(1,Ce,2,2,"a",6)(2,fe,2,1),p(),s(3,"div",7)(4,"p-button",8),m("onClick",function(){d(i);let e=u();return c(e.changeMode(!0))}),p()()}if(o&2){let i=u();v(i.textStyleClass),W("pTooltip",i.value),h("tooltipPosition",i.tooltipPosition),_(1),D(1,i.link?1:2),_(3),h("styleClass",i.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)}}var ue=(()=>{let r=class r{constructor(){this.buttonStyleClass="table-icon-button",this.tooltipPosition="top",this.onValueChange=new $,this.onModeChange=new $}onKeyDown({key:t}){this.mode&&t.toLowerCase()==="escape"&&this.changeMode(!1)}changeValue(){this.onValueChange.emit(this.inputValue)}changeMode(t){this.inputValue=`${this.value}`,this.onModeChange.emit(t)}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=y({type:r,selectors:[["app-editable-text"]],hostBindings:function(e,n){e&1&&m("keydown",function(a){return n.onKeyDown(a)},!1,L)},inputs:{value:"value",mode:"mode",link:"link",styleClass:"styleClass",textStyleClass:"textStyleClass",inputStyleClass:"inputStyleClass",buttonStyleClass:"buttonStyleClass",tooltipPosition:"tooltipPosition"},outputs:{onValueChange:"onValueChange",onModeChange:"onModeChange"},standalone:!0,features:[T],decls:3,vars:3,consts:[[1,"flex","align-items-center","hover-container",3,"document.keyup.esc"],["type","text","pInputText","",3,"ngModel","ngModelChange","keyup.enter"],[1,"flex","align-items-center","flex-nowrap","px-1"],["icon","pi pi-save",3,"styleClass","rounded","text","plain","disabled","onClick"],["icon","pi pi-times",3,"styleClass","rounded","text","plain","onClick"],["appTooltip","",3,"pTooltip","tooltipPosition"],["target","_blank","class","text-color no-underline hover:underline",3,"href"],[1,"toggle-edit-mode-button-container","hover-source","px-1"],["icon","pi pi-pencil",3,"styleClass","rounded","text","plain","onClick"],["target","_blank",1,"text-color","no-underline","hover:underline",3,"href"],[1,""]],template:function(e,n){e&1&&(s(0,"div",0),m("document.keyup.esc",function(){return n.changeMode(!1)}),x(1,he,4,12)(2,xe,5,9),p()),e&2&&(v(n.styleClass),_(1),D(1,n.mode?1:2))},dependencies:[w,ne,ee,te,ie,M,S,k,E,le,oe,pe]});let o=r;return o})();var ge=["table"];function be(o,r){if(o&1){let i=C();s(0,"div",5)(1,"div",6),I(2,"i",7),s(3,"input",8,9),m("input",function(){d(i);let e=j(4),n=u();return c(n.onSearchFilter(e.value))}),p()()()}}function ye(o,r){o&1&&(s(0,"tr")(1,"th",10)(2,"div",5)(3,"span",5),f(4,"Author Name"),p()()(),s(5,"th",5)(6,"div",5)(7,"span",5),f(8,"Author Link"),p()()(),I(9,"th",11),p())}function ve(o,r){if(o&1){let i=C();s(0,"tr",12)(1,"td",10)(2,"app-editable-text",13),m("onValueChange",function(e){let l=d(i).$implicit,a=u();return c(a.onMessage(a.messageType.UpdateAuthor,l,{name:e}))})("onModeChange",function(e){let l=d(i).$implicit,a=u();return c(a.onMessage(a.messageType.ChangeEditableMode,l,e?"name":""))}),p()(),s(3,"td",5)(4,"app-editable-text",13),m("onValueChange",function(e){let l=d(i).$implicit,a=u();return c(a.onMessage(a.messageType.UpdateAuthor,l,{link:e}))})("onModeChange",function(e){let l=d(i).$implicit,a=u();return c(a.onMessage(a.messageType.ChangeEditableMode,l,e?"link":""))}),p()(),s(5,"td",11)(6,"p-button",14),m("onClick",function(){let n=d(i).$implicit,l=u();return c(l.onMessage(l.messageType.RemoveAuthor,n))}),p()()()}if(o&2){let i=r.$implicit,t=u();_(2),h("value",i.name)("mode",(t.editable==null?null:t.editable.id)==i.id&&(t.editable==null?null:t.editable.type)=="name"),_(2),h("value",i.link)("mode",(t.editable==null?null:t.editable.id)==i.id&&(t.editable==null?null:t.editable.type)=="link"),_(2),h("rounded",!0)("text",!0)("plain",!0)}}var et=(()=>{let r=class r{constructor(){this._authorsSignal=O({authors:[],searchText:""}),this._articlesEffect=Q(()=>this.createTableValue(this._authorsSignal())),this._store$=b(X),this._elementRef=b(N),this._dialogService=b(B),this._subscriptions=[this._store$.select(Z).subscribe(t=>this._authorsSignal.update(e=>A(g({},e),{authors:t})))],this.editable={},this.messageType={UpdateAuthor:"update author",RemoveAuthor:"remove author",ChangeEditableMode:"change editable mode"},this.tableValue=[]}onWindowResize(){this._onResize&&typeof this._onResize=="function"&&this._onResize()}createTableValue({authors:t,searchText:e}){if(this.tableValue=e.length===0?t:t.filter(({name:n,link:l})=>`${n}`.toLowerCase().indexOf(e)>=0||`${l}`.toLowerCase().indexOf(e)>=0),!this._onResize){this._onResize=()=>{let l=this._elementRef.nativeElement.querySelector(".row");if(l){let{height:a}=l.getBoundingClientRect();this.table.virtualScrollItemSize=a}};let n=H([!0]).pipe(F(0)).subscribe(()=>{this._onResize(),n.unsubscribe()})}}onSearchFilter(t){this._authorsSignal.update(e=>A(g({},e),{searchText:`${t}`.toLowerCase()}))}onMessage(t,e,n){switch(t){case this.messageType.ChangeEditableMode:n?this.editable={id:`${e?.id}`,type:`${n}`}:this.editable=void 0;break;case this.messageType.UpdateAuthor:this._store$.dispatch(z.updateAuthor({authorId:`${e?.id}`,author:g({},n),callback:l=>{if(l){let{header:a,message:de}=l;this._store$.dispatch(V.showConfirmDialog({header:a,message:de,accept:{label:"Close"}}))}else this.onMessage(this.messageType.ChangeEditableMode)}}));break;case this.messageType.RemoveAuthor:this._store$.dispatch(V.showConfirmDialog({header:"Author delition",message:"Are you sure you want to delete an author",accept:{label:"Delete",action:()=>this._store$.dispatch(z.removeAuthor({authorId:`${e?.id}`}))},reject:{action:()=>{}}}));break;default:this._store$.dispatch(V.showConfirmDialog({header:"Error",message:"Not implemented yet",accept:{label:"Close"}}));break}}ngOnDestroy(){this._subscriptions.forEach(t=>t.unsubscribe())}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=y({type:r,selectors:[["app-authors"]],viewQuery:function(e,n){if(e&1&&G(ge,5),e&2){let l;K(l=J())&&(n.table=l.first)}},hostAttrs:[1,"flex","flex-column","overflow-hidden","h-full","settings-page"],hostBindings:function(e,n){e&1&&m("resize",function(a){return n.onWindowResize(a)},!1,P)},standalone:!0,features:[q([B]),T],decls:5,vars:4,consts:[["scrollHeight","flex",1,"w-full","h-full",3,"value","scrollable","virtualScroll","virtualScrollItemSize"],["table",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,""],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search",1,"w-30rem",3,"input"],["searchInput",""],[1,"w-4"],[1,"w-3rem"],[1,"row"],["textStyleClass","p-inputtext no-border max-w-full","inputStyleClass","w-12",3,"value","mode","onValueChange","onModeChange"],["icon","pi pi-trash","styleClass","",3,"rounded","text","plain","onClick"]],template:function(e,n){e&1&&(s(0,"p-table",0,1),x(2,be,5,0,"ng-template",2)(3,ye,10,0,"ng-template",3)(4,ve,7,7,"ng-template",4),p()),e&2&&h("value",n.tableValue)("scrollable",!0)("virtualScroll",!0)("virtualScrollItemSize",0)},dependencies:[w,M,S,k,E,Y,ae,re,se,ue]});let o=r;return o})();export{et as AuthorsComponent};
