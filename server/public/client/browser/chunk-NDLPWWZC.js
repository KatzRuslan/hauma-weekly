import{c as te,e as ce}from"./chunk-KHBZLRXD.js";import{a as B}from"./chunk-7YFTV6DD.js";import"./chunk-RYPVQAR5.js";import{b as re,c as se,m as de,p as pe}from"./chunk-LKTUHH2X.js";import{H as A,U as ne,X as ie,Z as oe,aa as P,ea as D,ia as T,ka as le,la as ae,ta as v,ua as E,wa as O,x as Z,xa as j,z as ee}from"./chunk-6ROSTETQ.js";import{Ab as W,Bb as C,Cb as f,Cc as Y,Dc as M,Ia as H,Ib as V,Ja as $,Ma as R,Oa as N,Sb as K,Ua as _,Ub as q,Wb as G,Xb as J,Za as w,Zb as X,cb as x,eb as F,gb as h,ia as S,ib as b,jb as I,ka as y,nb as s,ob as d,pa as p,pb as Q,qa as c,tb as g,vb as m,wb as a,zb as U}from"./chunk-QKGFT424.js";import{a as k,b as z,f as L}from"./chunk-ZFMGZBFO.js";function he(r,u){if(r&1){let t=g();s(0,"p-calendar",1),m("ngModelChange",function(e){p(t);let l=a();return c(l.calendarValue=e)}),d(),s(1,"div",2)(2,"p-button",3),m("onClick",function(){p(t);let e=a();return c(e.changeValue())}),d(),s(3,"p-button",4),m("onClick",function(){p(t);let e=a();return c(e.changeMode(!1))}),d()()}if(r&2){let t=a();x("ngModel",t.calendarValue)("placeholder",t.placeholder)("inputStyleClass",t.inputStyleClass)("showIcon",!0),_(2),x("styleClass",t.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)("disabled",!t.calendarValue||t.calendarValue==t.value),_(1),x("styleClass",t.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)}}function be(r,u){if(r&1){let t=g();s(0,"div")(1,"span",5),C(2),K(3,"date"),d()(),s(4,"div",6)(5,"p-button",7),m("onClick",function(){p(t);let e=a();return c(e.changeMode(!0))}),d()()}if(r&2){let t=a();h(t.textStyleClass),_(2),f(q(3,7,t.value,"dd-MMM-yyyy")),_(3),x("styleClass",t.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)}}var me=(()=>{let u=class u{constructor(){this.placeholder="Select Date",this.buttonStyleClass="table-icon-button",this.onValueChange=new w,this.onModeChange=new w}set _value(n){this.value=n?new Date(n):null}changeValue(){this.onValueChange.emit(this.calendarValue)}changeMode(n){n?this.calendarValue=this.value:this.calendarValue=null,this.onModeChange.emit(n)}};u.\u0275fac=function(e){return new(e||u)},u.\u0275cmp=y({type:u,selectors:[["app-editable-calendar"]],inputs:{_value:["value","_value"],mode:"mode",placeholder:"placeholder",styleClass:"styleClass",textStyleClass:"textStyleClass",inputStyleClass:"inputStyleClass",buttonStyleClass:"buttonStyleClass"},outputs:{onValueChange:"onValueChange",onModeChange:"onModeChange"},standalone:!0,features:[V],decls:3,vars:3,consts:[[1,"flex","align-items-center","hover-container",3,"document.keyup.esc"],["dateFormat","dd-M-yy","dataType","string","appendTo","body",3,"ngModel","placeholder","inputStyleClass","showIcon","ngModelChange"],[1,"flex","align-items-center","flex-nowrap","px-1"],["icon","pi pi-save",3,"styleClass","rounded","text","plain","disabled","onClick"],["icon","pi pi-times",3,"styleClass","rounded","text","plain","onClick"],[1,""],[1,"toggle-edit-mode-button-container","hover-source","px-1"],["icon","pi pi-pencil",3,"styleClass","rounded","text","plain","onClick"]],template:function(e,l){e&1&&(s(0,"div",0),m("document.keyup.esc",function(){return l.changeMode(!1)}),b(1,he,4,13)(2,be,6,10),d()),e&2&&(h(l.styleClass),_(1),I(1,l.mode?1:2))},dependencies:[M,Y,T,P,D,se,re,v,E]});let r=u;return r})();function ye(r,u){if(r&1){let t=g();s(0,"input",1),m("ngModelChange",function(e){p(t);let l=a();return c(l.inputValue=e)})("keyup.enter",function(){p(t);let e=a();return c(e.inputValue&&e.inputValue!=e.value?e.changeValue():void 0)}),d(),s(1,"div",2)(2,"p-button",3),m("onClick",function(){p(t);let e=a();return c(e.changeValue())}),d(),s(3,"p-button",4),m("onClick",function(){p(t);let e=a();return c(e.changeMode(!1))}),d()()}if(r&2){let t=a();h(t.inputStyleClass),x("ngModel",t.inputValue),_(2),x("styleClass",t.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)("disabled",!t.inputValue||t.inputValue==t.value),_(1),x("styleClass",t.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)}}function we(r,u){if(r&1&&(s(0,"a",9),C(1),d()),r&2){let t=a(2);x("href",t.link,R),_(1),f(t.value)}}function Ve(r,u){if(r&1&&(s(0,"span",10),C(1),d()),r&2){let t=a(2);_(1),f(t.value)}}function Me(r,u){if(r&1){let t=g();s(0,"div",5),b(1,we,2,2,"a",6)(2,Ve,2,1),d(),s(3,"div",7)(4,"p-button",8),m("onClick",function(){p(t);let e=a();return c(e.changeMode(!0))}),d()()}if(r&2){let t=a();h(t.textStyleClass),U("pTooltip",t.value),x("tooltipPosition",t.tooltipPosition),_(1),I(1,t.link?1:2),_(3),x("styleClass",t.buttonStyleClass)("rounded",!0)("text",!0)("plain",!0)}}var xe=(()=>{let u=class u{constructor(){this.buttonStyleClass="table-icon-button",this.tooltipPosition="top",this.onValueChange=new w,this.onModeChange=new w}onKeyDown({key:n}){this.mode&&n.toLowerCase()==="escape"&&this.changeMode(!1)}changeValue(){this.onValueChange.emit(this.inputValue)}changeMode(n){this.inputValue=`${this.value}`,this.onModeChange.emit(n)}};u.\u0275fac=function(e){return new(e||u)},u.\u0275cmp=y({type:u,selectors:[["app-editable-text"]],hostBindings:function(e,l){e&1&&m("keydown",function(i){return l.onKeyDown(i)},!1,$)},inputs:{value:"value",mode:"mode",link:"link",styleClass:"styleClass",textStyleClass:"textStyleClass",inputStyleClass:"inputStyleClass",buttonStyleClass:"buttonStyleClass",tooltipPosition:"tooltipPosition"},outputs:{onValueChange:"onValueChange",onModeChange:"onModeChange"},standalone:!0,features:[V],decls:3,vars:3,consts:[[1,"flex","align-items-center","hover-container",3,"document.keyup.esc"],["type","text","pInputText","",3,"ngModel","ngModelChange","keyup.enter"],[1,"flex","align-items-center","flex-nowrap","px-1"],["icon","pi pi-save",3,"styleClass","rounded","text","plain","disabled","onClick"],["icon","pi pi-times",3,"styleClass","rounded","text","plain","onClick"],["appTooltip","",3,"pTooltip","tooltipPosition"],["target","_blank","class","text-color no-underline hover:underline",3,"href"],[1,"toggle-edit-mode-button-container","hover-source","px-1"],["icon","pi pi-pencil",3,"styleClass","rounded","text","plain","onClick"],["target","_blank",1,"text-color","no-underline","hover:underline",3,"href"],[1,""]],template:function(e,l){e&1&&(s(0,"div",0),m("document.keyup.esc",function(){return l.changeMode(!1)}),b(1,ye,4,12)(2,Me,5,9),d()),e&2&&(h(l.styleClass),_(1),I(1,l.mode?1:2))},dependencies:[M,T,oe,P,D,ae,le,E,v,j,O,B]});let r=u;return r})();var Te=["table"];function ve(r,u){if(r&1){let t=g();s(0,"div",6)(1,"label",7),Q(2,"span",8),s(3,"input",9,10),m("change",function(){p(t);let e=W(4),l=a();return c(l.fileLoad(e.files))}),d()()()}}function Ee(r,u){if(r&1){let t=g();s(0,"div",6)(1,"p-button",11),m("onClick",function(){p(t);let e=a();return c(e.onMessage(e.messageType.UploadArticles))}),d()()}if(r&2){let t=a();_(1),x("disabled",t.isDisabled)("rounded",!0)("rounded",!0)("plain",!0)}}function Se(r,u){r&1&&(s(0,"tr",12)(1,"th",13)(2,"div",14)(3,"span",12),C(4,"Date / Issue Date"),d()()(),s(5,"th",15)(6,"div",14)(7,"span",12),C(8,"Type / Featured"),d()()(),s(9,"th",16)(10,"div",14)(11,"span",12),C(12,"Category / Source"),d()()(),s(13,"th",17)(14,"div",14)(15,"span",12),C(16,"Author / Autor Link"),d()()(),s(17,"th",18)(18,"div",14)(19,"span",12),C(20,"Title / Post Link"),d()()(),s(21,"th",19)(22,"div",14)(23,"span",12),C(24,"Subject / Tags"),d()()()())}function Ie(r,u){if(r&1){let t=g();s(0,"tr",20)(1,"td",13)(2,"app-editable-calendar",21),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{date:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"date":""))}),d()(),s(3,"td",15)(4,"app-editable-text",22),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{articleType:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"articleType":""))}),d()(),s(5,"td",16)(6,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{category:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"category":""))}),d()(),s(7,"td",17)(8,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{author:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"author":""))}),d()(),s(9,"td",18)(10,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{title:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"title":""))}),d()(),s(11,"td",19)(12,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{subject:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"subject":""))}),d()()(),s(13,"tr",12)(14,"td",13)(15,"app-editable-calendar",21),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{edition:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"edition":""))}),d()(),s(16,"td",15)(17,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{featured:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"featured":""))}),d()(),s(18,"td",16)(19,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{source:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"source":""))}),d()(),s(20,"td",17)(21,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{authorLink:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"authorLink":""))}),d()(),s(22,"td",18)(23,"app-editable-text",23),m("onValueChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.UpdateArticle,o,{link:e}))})("onModeChange",function(e){let o=p(t).rowIndex,i=a();return c(i.onMessage(i.messageType.ChangeEditableMode,o,e?"link":""))}),d()(),s(24,"td",19)(25,"div",24)(26,"span",12),C(27),d()()()()}if(r&2){let t=u.$implicit,n=u.rowIndex,e=a();F("surface-100",n%2==0),_(2),x("value",t.date)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="date"),_(2),x("value",t.articleType)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="articleType"),_(2),x("value",t.category)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="category"),_(2),x("value",t.author)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="author"),_(2),x("value",t.title)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="title"),_(2),x("value",t.subject)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="subject"),_(1),F("surface-100",n%2==0),_(2),x("value",t.edition)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="edition"),_(2),x("value",t.featured)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="featured"),_(2),x("value",t.source)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="source"),_(2),x("value",t.authorLink)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="authorLink"),_(2),x("value",t.link)("mode",(e.editable==null?null:e.editable.index)==n&&(e.editable==null?null:e.editable.type)=="link"),_(2),U("pTooltip",t.tags),_(2),f(t.tags)}}var bt=(()=>{let u=class u{constructor(){this._store$=S(ee),this._scannedActionsSubject$=S(Z),this._elementRef=S(N),this._spinnerService=S(ce),this.tableValue=[],this.editable={},this.messageType={UpdateArticle:"update article",UploadArticles:"upload articles",ChangeEditableMode:"change editable mode"},this._inproccess=!1,this._subscriptions=[this._scannedActionsSubject$.pipe(te(A.addParsedArticlesSuccess)).subscribe(({existed:n})=>this.tableValue=n)]}onWindowResize(){this._onResize&&typeof this._onResize=="function"&&this._onResize()}get isDisabled(){return this.tableValue.length===0||this._inproccess}fileLoad(n){return L(this,null,function*(){n&&n.length&&(this._spinnerService.activateSpinner(),this._store$.dispatch(A.getArticlesFromExcel({file:n[0],callback:e=>{this.tableValue=e,this._spinnerService.deactivateSpinner()}})))})}onMessage(n,e,l){switch(n){case this.messageType.ChangeEditableMode:(e||e===0)&&l?this.editable={index:e,type:`${l}`}:this.editable=void 0;break;case this.messageType.UpdateArticle:{let o=[...this.tableValue];o[e??0]=k(k({},o[e??0]),l),this.tableValue=o,this.editable=void 0}break;case this.messageType.UploadArticles:this._inproccess=!0,this._store$.dispatch(A.addParsedArticles({articles:this.tableValue.map(o=>z(k({},o),{tags:(o.tags||"").split(",").map(i=>i.trim())})),callback:o=>{if(o){let{header:i,message:Ce}=o;this._store$.dispatch(ie.showConfirmDialog({header:i,message:Ce,accept:{label:"Close"}}))}this._inproccess=!1}}));break;default:break}}ngOnDestroy(){this._subscriptions.forEach(n=>n.unsubscribe())}};u.\u0275fac=function(e){return new(e||u)},u.\u0275cmp=y({type:u,selectors:[["app-excel-uploader"]],viewQuery:function(e,l){if(e&1&&J(Te,5),e&2){let o;G(o=X())&&(l.table=o.first)}},hostAttrs:[1,"flex","flex-column","overflow-hidden","h-full","settings-page"],hostBindings:function(e,l){e&1&&m("resize",function(i){return l.onWindowResize(i)},!1,H)},standalone:!0,features:[V],decls:6,vars:4,consts:[["scrollHeight","flex",1,"articles-table","w-full","h-full",3,"value","scrollable","virtualScroll","virtualScrollItemSize"],["table",""],["pTemplate","caption"],["pTemplate","summary"],["pTemplate","header"],["pTemplate","body"],[1,"flex","justify-content-end","p-2"],["pripple","","type","button",1,"p-ripple","p-element","w-3rem","h-3rem","px-0","p-button","p-component","p-button-icon-only","p-button-rounded","p-button-lg","p-button-plain"],[1,"pi","pi-file-excel","text-xl","p-button-icon","ng-star-inserted"],["type","file","accept",".xls,.xlsx",1,"overflow-hidden","max-w-0","max-h-0",3,"change"],["inputFile",""],["icon","pi pi-upload text-xl","styleClass","w-3rem h-3rem px-0","size","large",3,"disabled","rounded","plain","onClick"],[1,""],[1,"article-date-cell"],[1,"px-2"],[1,"article-type-featured-cell"],[1,"article-category-source-cell"],[1,"article-author-cell"],[1,"article-title-cell"],[1,"article-subject-cell"],[1,"row"],["textStyleClass","p-inputtext no-border","inputStyleClass","datepicker-input",3,"value","mode","onValueChange","onModeChange"],["textStyleClass","p-inputtext no-border max-w-full","inputStyleClass","w-12",3,"value","mode","onValueChange","onModeChange"],["textStyleClass","p-inputtext no-border max-w-12","inputStyleClass","w-12",3,"value","mode","onValueChange","onModeChange"],["appTooltip","","tooltipPosition","left",1,"p-inputtext","no-border","max-w-12",3,"pTooltip"]],template:function(e,l){e&1&&(s(0,"p-table",0,1),b(2,ve,5,0,"ng-template",2)(3,Ee,2,4,"ng-template",3)(4,Se,25,0,"ng-template",4)(5,Ie,28,28,"ng-template",5),d()),e&2&&x("value",l.tableValue)("scrollable",!0)("virtualScroll",!0)("virtualScrollItemSize",0)},dependencies:[M,T,xe,me,E,v,ne,pe,de,j,O,B],styles:["[_nghost-%COMP%]     .article-date-cell{min-width:12rem;max-width:12rem}[_nghost-%COMP%]     .article-type-featured-cell{min-width:10rem;max-width:10rem}[_nghost-%COMP%]     .article-category-source-cell{min-width:10rem;max-width:10rem}[_nghost-%COMP%]     .article-author-cell{min-width:12rem;max-width:12rem}[_nghost-%COMP%]     .article-title-cell{min-width:12rem;max-width:12rem}[_nghost-%COMP%]     .article-subject-cell{min-width:10rem;max-width:10rem}[_nghost-%COMP%]     .table-icon-button.p-button.p-button-icon-only.p-button-rounded{width:1.4rem;height:1.4rem;padding:0;display:flex;justify-content:center;align-items:center}[_nghost-%COMP%]     .table-icon-button.p-button.p-button-icon-only.p-button-rounded .p-button-icon{font-size:.5rem}[_nghost-%COMP%]     .p-inputtext{background:transparent}[_nghost-%COMP%]     .p-inputtext.no-border{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]     .no-border{border-color:transparent}"]});let r=u;return r})();export{bt as ExcelUploaderComponent};
