import{a as w,b as h}from"./chunk-SOWXVAUG.js";import{ba as m}from"./chunk-QKGFT424.js";import{e as d,f as p}from"./chunk-ZFMGZBFO.js";var u=d(w()),f=d(h());var y=(()=>{let s=class s{parseTileLink(n,a,r){let e={articleTypeId:"",sourceId:""},[o]=`${n}`.toLowerCase().replace("://","\u2207").split("/").map(c=>c.replace("\u2207","://")),l=r.find(({provide:c})=>c===o);e.sourceId=`${l?.id??""}`;let t=["youtube","instagram"].includes(l?.selector??"")?"video":"post";return e.articleTypeId=a.find(({selector:c})=>c===t)?.id??"",e}parseAuthorLink(n){let[a,r]=`${n}`.replace("https://","").replace("http://","").replace("www.","").replace("@","").replace("#","").split("/"),e=`${r??""}`.replace(/[A-Z]/g,o=>` ${o}`).replace(/\_/g," ").replace(/\./g," ").split(" ").filter(o=>!!o&&o.length).map(o=>o.length>3?`${o.charAt(0).toUpperCase()}${o.slice(1)}`.trim():o).join(" ").replace(/\s\s/g," ");return e.length||([e]=(a??"").replace("@","").split("."),e=`${e.charAt(0).toUpperCase()}${e.slice(1)}`),e}_createArticlesExcel(n){return p(this,null,function*(){let a=new u.Workbook,r=a.addWorksheet("Hauma Weekly Report"),e=r.addRow(["Date","Type","Featured","Category","Source","Author","Author Link","Title","Post Link","Subject","Issue Date","Tags"]);e.font={name:"Roboto",family:4,size:11,bold:!0},n.forEach(t=>{let c=r.addRow([t.date,t.articleTypeName,t.featured,t.categoryName,t.sourceName,t.authorName,t.authorLink,t.title,t.link,t.subject,t.edition,t.tags.join(", ")]);c.font={name:"Roboto",family:4,size:11}});let o=[16,16,16,16,16,16,26,36,40,40,16,40];return r.columns.forEach((t,c)=>t.width=o.at(c)),yield a.xlsx.writeBuffer()})}downloadArticles(n){return p(this,null,function*(){let a=yield this._createArticlesExcel(n),r=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),e=document.createElement("a"),o=window.URL.createObjectURL(r);e.href=window.URL.createObjectURL(r),e.download=`hauma-weekly.${(0,f.default)().format("DD-MMM-YYYY")}.xlsx`,e.click(),window.URL.revokeObjectURL(o)})}};s.\u0275fac=function(a){return new(a||s)},s.\u0275prov=m({token:s,factory:s.\u0275fac,providedIn:"root"});let i=s;return i})();export{y as a};
